Discount Ascii Warehouse
====
To Run
----
- npm install
- npm run build-n-serve
- browse to localhost:8080

This will serve the built and minified production code.
For development:
- npm run start to spin up the server
- ng serve
- browse to localhost:4200 to have a debuggable dev environment with hot module reloading.
- I enabled CORS on the server for this but don't worry I reverted everything!

To Test
----
- ng test for karma component tests
- ng e2e for some basic e2e tests

Strategy
----
Debugging:
To debug this I ran the backend using npm run start and then ran the dev build of the UI seperately with ng serve.  I used sourcemaps to debug in the browser by opening dev tools then going to sources/webpack/{folder location}/src and placing my breakpoints here.
Due to the relative simplicity of this app a lot of problems were solved with good old logging to the console, which I then removed prior to checkin.
debugging in vscode is also possible by setting up attach to chrome in the debug menu.

Testing:
The hot module reloading enables instant feed back of every change.  I would have the app open with the console visible in dev tools and check for errors on every change.  Due to the limited scope of the app it was pretty easy to manually smoke test the features regularly.
As for automated tests, I left the basic insantiation tests generated by the cli and then added several component tests.
They are not all true unit tests that test only one method, but rather behaviour tests testing the component as a whole.  Both approaches would have been valid.
The framework for e2e tests is there and I have a very basic one to assert that everything loads.  If the app grew to have more behaviours it would be simple to flesh these out.

Software best practices:
The main point I made on my email about not trusting input from the UI is not relevant here as I was unable to alter the server code. 
My code is pretty well decoupled, allowing the various components(product list,ad,product etc) to be worked on separately or potentially reused in other places.
For example, I refactored out the storing of the previous ad url to prevent duplicates to the ad component class so that it is no longer dependent on a product-list to keep track of this.  The unique ads could be used elsewhere, and the product list could accept other entities.

Dependency injection is used to inject the http module as is standard Angular practice.
I tried to keep the classes and methods short and SRP and named in a way that it is easy to understand what everything does.
I used tslint to keep everything looking good.  In conjunction with the Angular cli this will make it easy for future developers to contribute to this project with consistent style.

I decided to use Angular CLI as this is what I'm using at work currently.  This uses rxJs for async.  I tried to keep the code readable,maintainable, testable, and with a pain-free environment for dev and building for production.

Challenges
----
I originally had the ad urls being passed as an @Input from the product-list into the ad component, with the getUrl function in the list template.  It worked fine up until I added the scroll event subscription for the infinite scrolling, then this for some reason caused the url to regenerate on every scroll event.
While this caused a storm of kitty cuteness, I refactored to a static method to get around this problem.

I noticed a couple of duplicate kitties at one point.  I thought there might be a bug but on inspection found they had different urls, so It couldbe that the api is serving dupes from time to time.

Feel free to ask any questions and talk soon!


Original Instructions:
Discount Ascii Warehouse
====


This is an ecommerce site, where you can buy all sorts of ascii faces like `(ノ・∀・)ノ` and `¯_(ツ)_/¯`, in a wide variety of font sizes. The homepage should display a list of products for people to browse.

Please read the instructions and FAQ below before beginning.

Features
----

- products are displayed in a grid.
- give the user an option to sort the products in ascending order. Can sort by "size", "price" or "id".
- each product has :
  - a "size" field, which is the font-size (in pixels). We should display the faces in their correct size, to give customers a realistic impression of what they're buying.
  - a "price" field, in cents. This should be formatted as dollars like `$3.51`.
  - a "date" field, which is the date the product was added to the catalog. Dates should be displayed in relative time (eg. "3 days ago") unless they are older than 1 week, in which case the full date should be displayed.
- the product grid should automatically load more items as you scroll down.
- our product database is under high load due to growing demand for ascii, so please display an animated "loading..." message while the user waits.
- to improve the user's experience, we should always pre-emptively fetch the next batch of results in advance, making use of idle-time.  But they still should not be displayed until the user has scrolled to the bottom of the product grid.
- when the user reaches the end and there are no more products to display, show the message "~ end of catalogue ~".

### Ads features

- after every 20 products we need to insert an advertisement from one of our sponsors. Use the same markup as the advertisement in the header, but make sure the `?r` query param is randomly generated each time an ad is displayed.
- Ads should be randomly selected, but a user must never see the same ad twice in a row.


Products API
----

- The basic query looks like this: `/api/products`
- The response format is newline-delimited JSON.
- To get a larger results set use the `limit` parameter, eg: `/api/products?limit=100`
- To paginate results use the `skip` parameter, eg: `/api/products?limit=15&skip=30` (returns 15 results starting from the 30th).
- To sort results use the `sort` parameter, eg: `/api/products?sort=price`. Valid sort values are `price`, `size` and `id`.

FAQ
----

### How do I start the app?

Start with `npm start`. The server will look for any files you add to the `static/` directory.

### Can I use {{ module_x }}?

Yes, that's fine.

### What about sort order (ascending / descending)?

We don't need to worry about alternate sort order for this project, we'll just use ascending-order for everything.

### Can I make changes to the backend or API?

No, your final solution should not include any changes to the server code.

### What should I do when I'm finished?

Please zip up your files and email them back, along with information about which features you have included in your solution.

### How is the exam graded?

We are looking for idiomatic use of javascript, and the ability to solve the problems with code that is clean and easy to read. Even though it's very small in scope, please show us how you would use the language and conventions to structure things in a clear and maintainable way.

Don't worry about visual aspects, ugly is fine :) Unless you would like to show us your UI skills, in which case, feel free :)

### This looks like it will take a while and I'm pretty busy

You're right! With something open-ended like this you could easily spend a week polishing and getting it just right. We don't expect you to do this, and we'll do our best to make sure you're not disadvantaged by this.

When we grade this exam we're not giving you a "score out of 100" for how many features you complete. We're trying to get some insight into your process, to see the way you work. So, by all means, spend more time if you want to. But you are also free to leave certain features out and give a written explanation of how you would approach it. The best approach is to spend your time on the features that you think is the best way to show us your strengths and experience.
